<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Oswald&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/home.css">
    <title>Aswhamedha'19</title>
</head>

<body>
    <header>
        <h1 class="anim animOpacity h2">Ashwamedha'19</h1>
    </header>
    <section id="date">
        <p class="anim animSideSlide h2 lightColor">
            <span>5</span>
            <span> </span>
            <span>&</span>
            <span> </span>
            <span>6</span>
            <span> </span>
            <span>N</span>
            <span>O</span>
            <span>V</span>
        </p>
    </section>
    <section id="rise" class="h1">
        <p><span>T</span><span>H</span><span>E</span></p>
        <p><span>S</span><span>T</span><span>A</span><span>L</span><span>L</span><span>I</span><span>O</span><span>N</span></p>
        <p><span>R</span><span>I</span><span>S</span><span>E</span><span>S</span></p>
        <div id="adi" class="anim h3 lightColor">
            <a>Adi Shankara Institute of Engineering and Technology</a>
        </div>
    </section>
    <section id="count">
        <div class="countItem anim animOpacity h2">
            <p class="countNo">2</p>
            <p class="countParam">Days</p>
            <div class="line"></div>
        </div>
        <div class="countItem anim animOpacity h2">
            <p id="eventsCount" class="countNo"></p>
            <p class="countParam">Events</p>
            <div class="line"></div>
        </div>
    </section>
    <section id="eventsTitle">
        <p class="anim animSideSlide h2 lightColor">
            <span>E</span>
            <span>V</span>
            <span>E</span>
            <span>N</span>
            <span>T</span>
            <span>S</span>
        </p>
    </section>
    <section id="eventsList"></section>
    <div id="eventDetails">
        <p id="close">Close</p>
        <h3 id="eTitle" class="h2"></h3>
        <p id="eSub"></p>
        <p id="eDesc"></p>
        <a href="https://www.yepdesk.com/buy-tickets/5db04f6ae4b0306426d58832" id="buyTickets" target="_blank"><button class="h3">Buy Tickets</button></a>
        <p id="eTimeVenue"></p>
        <p id="ePrice"></p>
        <div id="ePrizes">
        </div>
        <p id="eCoord">Coordinators</p>
        <div id="eCoords"></div>
        <p id="eRulesHead">Rules</p>
        <div id="eRules">
            <ol></ol>
        </div>
    </div>
    <script>
        let eventsList = {}

        let animate = () => {
            document.querySelectorAll('.anim').forEach(e => {
                if ((e.offsetTop - window.innerHeight / 1.2) < (window.scrollY || window.pageYOffset)) {
                    e.classList.add('animate')
                }
            })
        }

        let reveal = (e) => {
            e = e.target.innerText
            e = eventsList.events.filter(a => {
                return (a.name === e)
            })
            e = e[0]
            document.getElementById('eTitle').innerText = e.hasOwnProperty('name') ? e.name : ''
            document.getElementById('eSub').innerText = e.hasOwnProperty('sub') ? e.sub : ''
            document.getElementById('eDesc').innerText = e.hasOwnProperty('desc') ? e.desc : ''
            if (e.hasOwnProperty('day') && e.hasOwnProperty('time') & e.hasOwnProperty('venue'))
                document.getElementById('eTimeVenue').innerHTML = e.day + '<br>' + e.time + '<br>' + e.venue
            if (e.hasOwnProperty('price'))
                document.getElementById('ePrice').innerText = e.price
            document.getElementById('ePrizes').innerHTML = ''
            if (e.hasOwnProperty('first')) {
                let first = document.createElement('div')
                first.classList.add('prize')
                let amt = document.createElement('p')
                amt.innerText = e.first
                let prizetitle = document.createElement('p')
                prizetitle.innerText = 'First Prize'
                first.append(amt)
                first.append(prizetitle)
                document.getElementById('ePrizes').append(first)
            }
            if (e.hasOwnProperty('second')) {
                let second = document.createElement('div')
                second.classList.add('prize')
                let amt = document.createElement('p')
                amt.innerText = e.second
                let prizetitle = document.createElement('p')
                prizetitle.innerText = 'Second Prize'
                second.append(amt)
                second.append(prizetitle)
                document.getElementById('ePrizes').append(second)
            }
            if (e.hasOwnProperty('third')) {
                let third = document.createElement('div')
                third.classList.add('prize')
                let amt = document.createElement('p')
                amt.innerText = e.second
                let prizetitle = document.createElement('p')
                prizetitle.innerText = 'Third Prize'
                third.append(amt)
                third.append(prizetitle)
                document.getElementById('ePrizes').append(third)
            }
            if (e.hasOwnProperty('prize')) {
                let prize = document.createElement('div')
                prize.classList.add('prize')
                let amt = document.createElement('p')
                amt.innerText = e.second
                let prizetitle = document.createElement('p')
                prizetitle.innerText = 'Worth Prizes'
                prize.append(amt)
                prize.append(prizetitle)
                document.getElementById('ePrizes').append(prize)
            }
            document.getElementById('eCoords').innerHTML = ''
            if (e.hasOwnProperty('students')) {
                document.getElementById('eCoord').innerText = 'Coordinators'
                e.students.forEach((a) => {
                    let student = document.createElement('div')
                    student.classList.add('coordinator')
                    let studentName = document.createElement('p')
                    studentName.innerText = a.name
                    let studentNo = document.createElement('p')
                    studentNo.innerText = a.mob
                    student.append(studentName)
                    student.append(studentNo)
                    document.getElementById('eCoords').append(student)
                })
            }
            else {
                document.getElementById('eCoord').innerText = ''
            }
            let generalRule = document.createElement('li')
            generalRule.innerText = 'General rules of ASHWAMEDHA â€™19 is applicable for this event. '
            let rulesDoc = document.createElement('a')
            rulesDoc.setAttribute('href', '/assets/docs/ashwamedha19rules.pdf')
            rulesDoc.setAttribute('download', 'Ashwamedha19 Rules.pdf')
            rulesDoc.innerText = 'Click here to download the rules.'
            generalRule.append(rulesDoc)
            document.querySelector('#eRules ol').innerHTML = ''
            document.querySelector('#eRules ol').append(generalRule)
            if (e.hasOwnProperty('rules')) {
                e.rules.forEach(r => {
                    if (Array.isArray(r)) {
                        let ruleList = document.createElement('ol')
                        r.forEach(ru => {
                            let rule = document.createElement('li')
                            rule.innerText = ru
                            ruleList.append(rule)
                        })
                        document.querySelector('#eRules ol').append(ruleList)
                    }
                    else {
                        let rule = document.createElement('li')
                        rule.innerText = r
                        document.querySelector('#eRules ol').append(rule)
                    }
                })
            }
            document.getElementById('eventDetails').classList.add('reveal')
            document.querySelector('html').classList.add('noScroll')
            document.querySelector('body').classList.add('noScroll')
        }

        let close = () => {
            document.getElementById('eventDetails').classList.remove('reveal')
            document.querySelector('html').classList.remove('noScroll')
            document.querySelector('body').classList.remove('noScroll')
        }

        let displayEvents = () => {
            fetch('/assets/data/events.json').then(response => {
                return response.json()
            }).then(data => {
                eventsList = data
                document.getElementById('eventsCount').innerText = eventsList.events.length
                eventsList.events.forEach(e => {
                    let h2 = document.createElement('h2')
                    h2.classList.add('h3', 'anim', 'animOpacity')
                    h2.addEventListener('click', e => {
                        reveal(e)
                    })
                    h2.innerText = e.name
                    document.getElementById('eventsList').append(h2)
                })
            })
        }

        let title = () => {
            let intrvl = setInterval(() => {
                let n = 0
                if ((n = document.querySelectorAll('#rise p span:not(.reveal)').length) > 0) {
                    document.querySelectorAll('#rise p span:not(.reveal)')[Math.floor(Math.random() * n)].classList.add('reveal')
                }
                else {
                    clearInterval(intrvl)
                }
            }, 100)
        }

        animate()
        window.onscroll = animate
        window.onresize = animate
        title()
        displayEvents()
        document.getElementById('close').addEventListener('click', () => {
            close()
        })
    </script>
</body>

</html>